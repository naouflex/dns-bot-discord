version: '3.8'

services:
  dns_monitor:
    build: 
      context: .
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    environment:
      - DATABASE_URL=${DATABASE_URL}
      - DISCORD_BOT_TOKEN=${DISCORD_BOT_TOKEN}
      - DISCORD_PUBLIC_KEY=${DISCORD_PUBLIC_KEY}
      - DISCORD_APPLICATION_ID=${DISCORD_APPLICATION_ID}
      - DISCORD_WEBHOOK_URL=${DISCORD_WEBHOOK_URL}
      - DISCORD_ROLE_ID=${DISCORD_ROLE_ID}
      - DISCORD_GUILD_ID=${DISCORD_GUILD_ID}
      - DISCORD_CHANNEL_ID=${DISCORD_CHANNEL_ID}
      - CHECK_INTERVAL_SECONDS=${CHECK_INTERVAL_SECONDS:-60}
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
      - VOTE_TIMEOUT_HOURS=${VOTE_TIMEOUT_HOURS:-24}
      - MIN_VOTES_REQUIRED=${MIN_VOTES_REQUIRED:-2}
      - MAJORITY_THRESHOLD=${MAJORITY_THRESHOLD:-0.6}
      - DNS_RESOLVERS=${DNS_RESOLVERS:-1.1.1.1,8.8.8.8,9.9.9.9}
      - DNS_TIMEOUT=${DNS_TIMEOUT:-5}
    restart: unless-stopped
    volumes:
      - ./logs:/app/logs
